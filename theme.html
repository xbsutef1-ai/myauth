<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GLOM Panel</title>
<style>
body{background:#000;color:#fff;font-family:Arial}
.card{width:420px;margin:80px auto;border:1px solid #300;padding:20px}
input,button{width:100%;padding:10px;margin:5px 0}
button{background:#900;color:#fff;border:none}
.hidden{display:none}
pre{background:#111;padding:10px}
</style>
</head>
<body>

<div class="card" id="login">
<h2>Login</h2>
<input id="u" placeholder="Username">
<input id="p" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<div id="err"></div>
</div>

<div class="card hidden" id="panel">
<h2 id="role"></h2>
<button onclick="loadLic()">Licenses</button>
<button id="logsBtn" onclick="loadLogs()">Logs</button>
<pre id="out"></pre>
<button onclick="logout()">Logout</button>
</div>

<script>
let T="", R="";
function login(){
 fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},
 body:JSON.stringify({username:u.value,password:p.value})})
 .then(r=>r.json()).then(d=>{
  if(!d.token){err.innerText="Login failed";return;}
  T=d.token; R=d.role;
  login.classList.add("hidden");
  panel.classList.remove("hidden");
  role.innerText="ROLE: "+R;
  if(!["MASTER","OWNER"].includes(R)) logsBtn.style.display="none";
 });
}
function loadLic(){
 fetch("/licenses",{headers:{Authorization:"Bearer "+T}})
 .then(r=>r.json()).then(d=>out.textContent=JSON.stringify(d,null,2));
}
function loadLogs(){
 fetch("/logs",{headers:{Authorization:"Bearer "+T}})
 .then(r=>r.json()).then(d=>out.textContent=JSON.stringify(d,null,2));
}
function logout(){
 T=""; panel.classList.add("hidden"); login.classList.remove("hidden");
}
</script>

</body>
</html>
